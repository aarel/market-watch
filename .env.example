# Market-Watch Environment Configuration
#
# This is a template file. Copy it to .env and fill in your specific values.
# NEVER commit your .env file to version control.

#--------------------------------------------------------------------------
# Core Settings
#--------------------------------------------------------------------------

# Alpaca API credentials
# Get these from https://app.alpaca.markets/paper/dashboard/overview
ALPACA_API_KEY=your_api_key_here
ALPACA_SECRET_KEY=your_secret_key_here

# Trading mode: "paper" or "live". Use "live" with extreme caution.
TRADING_MODE=paper

# Simulation mode: "true" or "false"
# When true: Uses FakeBroker with synthetic market data. Market is always "open".
#   - Useful for testing strategies after market hours or on weekends
#   - Generates realistic price movements for training/development
#   - No real API calls to Alpaca for market data
# When false: Uses real Alpaca API for market data (respects market hours)
SIMULATION_MODE=false

# Market data feed:
# "iex" = Free tier (IEX exchange data only)
# "sip" = Paid tier (full market data, requires Alpaca subscription)
DATA_FEED=iex

#--------------------------------------------------------------------------
# Strategy Selection & Parameters
#--------------------------------------------------------------------------

# Strategy to use: "momentum", "mean_reversion", "breakout", "rsi"
STRATEGY=momentum

# -- Momentum Strategy Parameters --
LOOKBACK_DAYS=20
MOMENTUM_THRESHOLD=0.02
SELL_THRESHOLD=-0.01

# Other strategy parameters (MeanReversion, Breakout, RSI) are currently
# configured in their respective files in the strategies/ directory.

#--------------------------------------------------------------------------
# Trading Behavior
#--------------------------------------------------------------------------

# Enable or disable automatic trading
AUTO_TRADE=true

# Interval in minutes for the bot to fetch data and evaluate trades
TRADE_INTERVAL_MINUTES=5

# Require manual approval for each trade (not yet implemented)
REQUIRE_APPROVAL=false

# Watchlist mode:
# "static" = uses the hardcoded watchlist in config.py
# "top_gainers" = dynamically fetches a list of top-moving stocks
WATCHLIST_MODE=top_gainers
TOP_GAINERS_COUNT=10
TOP_GAINERS_UNIVERSE=large_cap
TOP_GAINERS_MIN_PRICE=5
TOP_GAINERS_MIN_VOLUME=1000000

#--------------------------------------------------------------------------
# Risk Management & Position Sizing
#--------------------------------------------------------------------------

# -- Core Risk Limits --
# Max % of portfolio to allocate to a single position (e.g., 0.1 for 10%)
MAX_POSITION_PCT=0.20

# Stop loss percentage (e.g., 0.05 for 5%)
STOP_LOSS_PCT=0.05

# Max number of concurrent open positions
MAX_OPEN_POSITIONS=10

# NOTE: Runtime config in data/config_state.json will override these .env defaults
# after the first run. Changes via UI are persisted to config_state.json.

# -- Circuit Breakers --
# Max % of portfolio value that can be lost in a single day before pausing buys
DAILY_LOSS_LIMIT_PCT=0.03

# Max % drawdown from portfolio peak before pausing buys
MAX_DRAWDOWN_PCT=0.15

# Maximum number of trades allowed in one day
MAX_DAILY_TRADES=10

# -- Exposure Limits --
# Max % of portfolio allowed in a single market sector
MAX_SECTOR_EXPOSURE_PCT=0.30

# Max % of portfolio allowed in positions that are highly correlated
MAX_CORRELATED_EXPOSURE_PCT=0.40
CORRELATION_THRESHOLD=0.8
CORRELATION_LOOKBACK_DAYS=30

# -- Position Sizing --
# Scale position size based on signal strength (e.g., stronger momentum = bigger position)
POSITION_SIZER_SCALE_BY_STRENGTH=true
POSITION_SIZER_MIN_STRENGTH=0.0
POSITION_SIZER_MAX_STRENGTH=1.0

#--------------------------------------------------------------------------
# System & API
#--------------------------------------------------------------------------

# Server host and port
API_HOST=127.0.0.1
API_PORT=8000

# Set a secret token here to protect your API from unauthorized access
API_TOKEN=
ALLOWED_ORIGINS=http://127.0.0.1:8000,http://localhost:8000

# Timezone for resetting daily limits (e.g., daily trade counter)
MARKET_TIMEZONE=America/New_York

# Market index ETFs to display in the UI ticker
MARKET_INDEX_SYMBOLS=SPY,QQQ,DIA

# Optional: Discord/Slack webhook URL for notifications
WEBHOOK_URL=

#--------------------------------------------------------------------------
# Data & Services
#--------------------------------------------------------------------------

# Financial Modeling Prep API key for updating sector data
FMP_API_KEY=
FMP_BASE_URL=https://financialmodelingprep.com/api/v3

# Path to the sector map file used by the RiskAgent
SECTOR_MAP_PATH=data/sector_map.json

# Alternative to file path, provide the entire map as a JSON string
SECTOR_MAP_JSON=

#--------------------------------------------------------------------------
# Analytics & Observability
#--------------------------------------------------------------------------

# Enable the analytics engine to capture performance data for the UI
ANALYTICS_ENABLED=true

# Enable structured logging for agent evaluations
OBSERVABILITY_ENABLED=true
OBSERVABILITY_LOG_PATH=logs/observability/agent_events.jsonl
OBSERVABILITY_MAX_LOG_MB=5

# Enable scheduled evaluations of agent behavior
OBSERVABILITY_EVAL_ENABLED=true
OBSERVABILITY_EVAL_INTERVAL_MINUTES=30
OBSERVABILITY_EVAL_OUTPUT_PATH=logs/observability/latest_eval.json
OBSERVABILITY_EVAL_REPORT_PATH=logs/observability/latest_report.txt
